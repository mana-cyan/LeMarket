<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lemarket.data.dao.CommentMapper">
  <resultMap id="BaseResultMap" type="com.lemarket.data.model.Comment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="commodity" jdbcType="INTEGER" property="commodity" />
    <result column="user" jdbcType="INTEGER" property="user" />
    <result column="time" jdbcType="TIMESTAMP" property="time" />
    <result column="content" jdbcType="LONGVARCHAR" property="content" />
  </resultMap>
  <insert id="insert" parameterType="com.lemarket.data.model.Comment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into Comment (id, commodity, user, 
      time, content)
    values (#{id,jdbcType=INTEGER}, #{commodity,jdbcType=INTEGER}, #{user,jdbcType=INTEGER}, 
      #{time,jdbcType=TIMESTAMP}, #{content,jdbcType=LONGVARCHAR})
  </insert>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select id, commodity, user, time, content
    from Comment
  </select>


  <resultMap id="CommentWithUser" type="com.lemarket.data.model.CommentWithUser">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="commodity" jdbcType="INTEGER" property="commodity" />
    <result column="time" jdbcType="TIMESTAMP" property="time" />
    <result column="content" jdbcType="LONGVARCHAR" property="content" />
    <association property="user" javaType="com.lemarket.data.model.Users">
      <result column="uid" jdbcType="INTEGER" property="id" />
      <result column="uusername" jdbcType="VARCHAR" property="username" />
      <result column="upassword" jdbcType="VARCHAR" property="password" />
      <result column="uemail" jdbcType="VARCHAR" property="email" />
      <result column="usalt" jdbcType="VARCHAR" property="salt" />
      <result column="urole" jdbcType="INTEGER" property="role" />
      <result column="ubirthday" jdbcType="DATE" property="birthday" />
      <result column="ugender" jdbcType="VARCHAR" property="gender" />
      <result column="uviewCount" jdbcType="INTEGER" property="viewcount" />
      <result column="uphoneNumber" jdbcType="VARCHAR" property="phonenumber" />
      <result column="uidentityNumber" jdbcType="VARCHAR" property="identitynumber" />
      <result column="ustatus" jdbcType="INTEGER" property="status" />
      <result column="udescription" jdbcType="LONGVARCHAR" property="description" />
      <result column="uaddress" jdbcType="LONGVARCHAR" property="address" />
    </association>
  </resultMap>

    <select id="selectPageById" resultMap="BaseResultMap">
      SELECT c.id, c.commodity, c.time, c.content,
        u.id as uid, u.username as uusername, u.password as upassword,
        u.email as uemail, u.salt as usalt, u.role as urole,
        u.birthday as ubirthday, u.gender as ugender, u.viewCount as uviewCount,
        u.phoneNumber as uphoneNumber, u.identityNumber as uidentityNumber, u.status as ustatus,
        u.description as udescription, u.address as uaddress
      FROM Comment c, Users u
      WHERE c.user = u.id and c.commodity = #{commodityId}
      ORDER by c.id DESC
      LIMIT #{beginRow}, #{pageSize};
    </select>
</mapper>